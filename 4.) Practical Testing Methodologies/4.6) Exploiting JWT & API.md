## Exploiting Misconfigured APIs and JWTs

#### ðŸŒ³ Why APIs and JWTs Are Prime Targets ?
Modern applications rely heavily on APIs for frontend/backend communication, and they often use JWTs (JSON Web Tokens) 
for authentication and session handling. When APIs are misconfigured or JWTs are poorly implemented, they become 
high-value bug bounty targets, exposing users and systems to severe risks.


#### ðŸŒ³ Common API Misconfigurations:-
- Improper authentication checks (e.g., no token verification)
- Excessive data exposure (returning too much info)
- Broken object-level authorization (BOLA/IDOR)
- Rate-limiting issues (allowing brute-force or abuse)
- Debug endpoints exposed in production
- CORS misconfigurations allowing cross-origin data access

These flaws are frequent in both REST and GraphQL APIs.


#### ðŸŒ³ Discovering API Endpoints:-
- Proxy traffic using Burp Suite or a mobile device
- Monitor JavaScript files with tools like LinkFinder or manual review
- Check Swagger/OpenAPI docs at paths like /swagger.json or /api-docs/
- Subdomain and directory enumeration may reveal staging or internal APIs

Example:
  
     GET /api/admin/users?id=123

Change id to test for IDOR or role misconfigurations.


#### ðŸŒ³ Common JWT Misconfigurations:-
- None algorithm: Token with "alg": "none" accepted without signature verification
- Symmetric key misuse: Using weak or guessable keys like "secret"
- Public key as HMAC key: Server uses a public RSA key as HMAC key (confuses key types)
- Token not expired: Tokens donâ€™t expire or allow extension
- Lack of issuer/audience checks

Each misconfiguration opens the door for token forgery, impersonation, or privilege escalation.

Tools:

     https://jwtlens.netlify.app/ https://github.com/DontPanicO/jwtXploiter https://github.com/hahwul/jwt-hack


#### ðŸŒ³ JWT Testing Techniques:- 
- Use tools like jwt.io, Burp Decoder, Hackvertor, or CLI tools (jwt_tool.py)
- Try altering claims like role, admin, user_id
- Test "alg": "none" or switch RS256 to HS256 with your own key
- Brute-force weak secrets (try common ones with jwt_tool, jwtcrack, or cewl)

Example (manipulated token):

    {
      "alg": "none",
      "typ": "JWT"
    }


#### ðŸŒ³ Exploiting API Logic Flaws:-
Focus on:
- Privilege escalation via user-modifiable fields
- Method-based bypass: GET vs POST differences in access control
- Parameter pollution or shadowing
- Missing field validation (e.g., bypassing restrictions with extra fields)
- Session replay or reuse via tokens

Test if an API trusts fields like:
- `X-User-ID`
- `Authorization: Bearer <token>`
- `X-Forwarded-For`

#### ðŸŒ³ GraphQL-Specific Weaknesses:- 
- Introspection enabled: Allows full schema enumeration
- Lack of rate limits on deeply nested queries (DoS)
- No field-level access control (you can query sensitive data)
- Use tools like `GraphQLmap` , `InQL` , and Burp plugins to explore schema and test access

#### ðŸŒ³ API Abuse Cases:-
- Mass assignment: API accepts extra fields like `is_admin=true`
- Replay attacks: Same token or request body reused to trigger actions
- Business logic bypass: Example: changing order amount or shipping method

Always trace workflows end-to-end. APIs often expose operations that the frontend masks.


#### ðŸŒ³ Reporting Tips:-
- Include full request/response, original vs modified
- Explain how the JWT or API logic can be abused
- Include impact clearly (data exfiltration, privilege escalation, account takeover)
- Suggest remediations: validating tokens correctly, enforcing least privilege, disabling unused API endpoints


#### ðŸŒ³ Final Insight:- 
APIs are powerful but fragile interfaces. Misconfigurations are common â€” but only apparent to those who read 
between the lines. JWTs and APIs demand precise, low-noise testing and a clear understanding of authentication 
and authorization flows. These bugs often go unnoticed by automation and are among the most rewarded findings.
