 ## Subdomain Takeover: From DNS Misconfigs to Cloud Misuse
  `GET`

 #### ‚ö†Ô∏è What is Subdomain Takeover?

A website can have smaller parts called subdomains. Sometimes companies stop using a subdomain but forget to remove it properly. That subdomain still points to a service (like GitHub Pages, AWS, Azure, etc.) but the service is no longer active.
- Example:

      Main site: example.com
      Subdomain: blog.example.com or shop.example.com

 This leaves an empty house with the door unlocked.

 #### üß© How Hackers Exploit It:-
- Hacker notices the subdomain is unused but still exists. They register the same service (like GitHub Pages or AWS bucket) under that subdomain. Now they can control content on blog.example.com ‚Äî even though they don‚Äôt own example.com.
- It‚Äôs a DNS-level misconfiguration where the CNAME exists, but the resource is unclaimed or removed.


#### üå≥ Why It Matters?
Subdomain takeovers can lead to:
- Phishing under a trusted domain
- Session cookie theft via `.target.com`
- Browser-based attacks (e.g., JavaScript injection)
- Hosting malicious payloads disguised as legit assets
- Reputation abuse or SEO manipulation


#### üå≥ Commonly Abused Services:-
Services commonly involved in takeovers include:
- GitHub Pages (CNAME)
- AWS S3 buckets
- Azure Blob Storage
- Heroku apps
- Fastly, Cloudfront
- Shopify, Zendesk, Desk.com
- Readme.io, Bitbucket
- Pantheon, Unbounce, Cargo, Tilda
  
These platforms allow custom domain bindings and often don't check if DNS is still valid after resource deletion.


#### üå≥ How to Identify Vulnerable Subdomains:-
##### 1.) Subdomain Enumeration:
Use tools like:
- `subfinder`, `amass`, `assetfinder`, `sublist3r`
- Passive sources (crt.sh, SecurityTrails, VirusTotal)
  
##### 2.) DNS Resolution Check:
- Identify subdomains with CNAMEs pointing to third-party services:

           dig +short sub.target.com  

##### 3.) Manual/Automated Detection:
- Check for known "404" messages or signature error pages
- Use tools like `Subjack`, `Takeover`, `tko-subs`, `nuclei` with takeover templates


#### üå≥ Fingerprinting Services:-
Each third-party provider has unique error responses when a resource is missing. Example signatures:
- GitHub Pages: `There isn't a GitHub Pages site here.`
- Heroku: `No such app`
- AWS S3: `The specified bucket does not exist`
- Shopify: `Sorry, this shop is currently unavailable`
- Azure: `No such host is known`

Tools like SubOver, Subzy, or Subjack include these signatures and scan for potential takeovers.


#### üå≥ Real-World Example:- 
##### 1.) DNS entry:

          blog.target.com ‚Üí CNAME ‚Üí target.github.io  

##### 2.)The repository target.github.io no longer exists.
##### 3.)Attacker creates the repo target.github.io on their account.
##### 4.)They now control blog.target.com, serve HTML/JS, and exploit trust in that subdomain.


#### üå≥ Exploitation Scenarios:-
- Inject custom JS for session hijacking (if cookies are scoped to `*.target.com`)
- Redirect users to phishing pages
- Deliver malicious downloads via the trusted domain
- Use for SPF/DMARC abuse in email spoofing
- SEO poisoning or brand defacement

#### üå≥ Preventing Subdomain Takeover:- 
- Audit DNS records regularly
- Remove orphaned CNAME records immediately
- Monitor third-party service usage and deprovisioning
- Use DNS monitoring tools or continuous asset tracking (e.g., `SecurityTrails`, `Amass` with diffing)
- Employ wildcard DNS catch-alls only with caution

#### üå≥ Tools to Automate Takeover Discovery:-
- Subjack [https://github.com/haccer/subjack]
- Takeover [https://github.com/m4ll0k/takeover]
- Nuclei with `takeover-* templates [https://github.com/projectdiscovery/nuclei]
- SubOver [https://github.com/Ice3man543/SubOver]
- Tko-subs [https://github.com/anshumanbh/tko-subs]
- Amass [https://github.com/owasp-amass/amass]

These tools automate detection, signature matching, and optionally verify vulnerability.


#### üå≥ Reporting and Impact:-
When submitting a takeover bug:
- Provide DNS records and CNAME chain
- Include proof of control (HTML payload or screenshot)
- Explain how it could impact the user, brand, or cookies
- Emphasize phishing, session theft, or data exposure potential

Programs may consider this high or critical depending on the exposure level and subdomain usage.
