## Server-Side Request Forgery (SSRF): Internal Port Scans, AWS Metadata

#### üå≥ What is SSRF
- SSRF is a security flaw where an attacker tricks a server into making HTTP requests to any domain or internal
  system. The attacker can‚Äôt fully control the response, but they can notice things like delays, status codes,
  or partial data to exploit it. SSRF is especially risky in cloud setups, because internal services and metadata
  endpoints are often exposed inside the network.‚Äù


#### üå≥ SSRF typically Appears:-
SSRF can be found in any functionality that fetches external resources or interacts with URLs, such as:
- Image uploaders (that fetch and validate image URLs)
- PDF generators that pull web content
- URL preview generators
- Webhooks
- Import/export features
- Backend admin tools
- SSR template engines (server-side rendering)

Common parameters: 
      `url=`, `target=`, `path=`, `redirect=`, `link=`, `callback=`, `next=`


#### üå≥ Key SSRF Targets:-
Once SSRF is identified, attackers often go after:
- Cloud Metadata APIs

        e.g., AWS: http://169.254.169.254/latest/meta-data/
  
- Internal applications or APIs
  
        http://localhost, http://127.0.0.1, http://internal-api

- Open ports on the internal network:
  
        http://10.0.0.1:2375
  
Redis, Gopher, FTP, File Protocols: if SSRF is extended to non-HTTP schemes


  #### üå≥ SSRF via Redirects and DNS Rebinding
Even if direct access to internal resources is blocked, advanced attackers use:
- Open redirect chaining: SSRF target points to a redirector that leads to internal host
- DNS rebinding: using attacker-controlled DNS that resolves to an external IP and then switches to 127.0.0.1

Payload example:

     http://your-dns-rebind-domain.com


#### üå≥ Exploitation Examples
- Basic SSRF:

        GET /fetch?url=http://example.com
        ‚Üí change to ‚Üí /fetch?url=http://localhost:8000

 - Access metadata endpoint (AWS):

         http://169.254.169.254/latest/meta-data/iam/security-credentials/

- Force server to make external requests:

         http://your-burpcollaborator-url.com

This detects blind SSRF if no error or output is returned.


#### üå≥ Blind SSRF Detection:-
When the application does not return the response blind SSRF techniques are used, Out-of-band (OOB) via tools like:
- Interactsh
- Burp Collaborator
- Custom DNS logger

These tools notify you when the vulnerable server makes a request to your listener.


#### üå≥ Gaining Internal Access via SSRF:-

    Scan internal ranges:
        127.0.0.1, 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16
    Attempt to reach:
        Redis: redis://127.0.0.1:6379
        Docker API: http://127.0.0.1:2375/containers/json
        Kubernetes: http://localhost:8001/api/v1/pods

You may not see full responses, but HTTP status codes and time delays give valuable clues.


#### üå≥ SSRF in the Cloud and Impact Escalation:-
In cloud setups (AWS, GCP, Azure), SSRF can lead to:
- IAM role credential theft via metadata API
- Lateral movement into internal services
- Discovery of internal dashboards and misconfigurations
- Exposure of internal secrets, config files, or tokens

Example AWS SSRF Chain:

    SSRF to http://169.254.169.254/latest/meta-data/iam/security-credentials/role-name
    Extract temporary credentials
    Use them with awscli to access buckets or EC2


#### üå≥ Defense Mechanisms You‚Äôll Encounter:-

Modern apps may use filters or allowlists:
- Block localhost, 127.0.0.1
- DNS rebinding protection
- CIDR range filtering
- Regex checks on protocols (http://, file://, etc.)
- Headers like Host, User-Agent may be filtered

However, attackers often bypass protections using:
- Decimal or octal IP encodings
- IPv6 localhost [::1]
- Nested redirects
- DNS poisoning or manipulation

#### üå≥ Real-World SSRF Reports and Value:-

SSRF often appears in top-paid HackerOne reports, especially when:
- It leads to internal data exposure
- Results in cloud credential theft
- Enables port scanning or remote code execution (via chained bugs)

High-impact SSRF reports typically show creativity in chaining low-severity SSRF with high-value internal 
services.
