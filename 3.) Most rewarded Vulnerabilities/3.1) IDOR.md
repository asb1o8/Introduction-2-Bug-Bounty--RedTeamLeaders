## Insecure Direct Object Reference (IDOR): Logic Flaws and Broken Access

- IDOR occurs when an application exposes internal object references (like user IDs, order numbers, filenames) without enforcing proper access control. Attackers manipulate these identifiers to access unauthorized resources, making IDOR one of the most rewarded vulnerabilities in bug bounty programs.


#### ðŸŒ³ Understanding the Core of IDOR:-
It isn't just about numbers in URLs. Itâ€™s a broken access control issue where:
- Access to sensitive objects is not validated.
- The application trusts user input without authorization checks.
- User-controlled input maps directly to backend resources.

Examples:

    /api/user/1234/profile
    /download?file=invoice_456.pdf


#### ðŸŒ³ Common Locations Where IDOR Appears:-
- User profiles: GET /users/123
- Billing/invoices: GET /invoices/456
- Messages and chats: GET /messages/789
- File downloads: GET /download/file/123
- Password reset tokens: GET /reset-password/token123

Sometimes the vulnerability exists in POST or PUT requests too â€” not just GET.


#### ðŸŒ³ Horizontal vs Vertical Privilege Escalation:-
- Horizontal IDOR: Allows a user to access resources belonging to other users with the same role. Ex- A normal user changes the user_id=123 in a URL to user_id=124 and sees another personâ€™s profile.
- Vertical IDOR: Allows a user to perform actions or access resources reserved for higher privilege roles. Ex- A regular user modifies a request parameter to access /admin/settings and successfully changes system configurations.


#### ðŸŒ³ How to Identify Potential IDOR Vulnerabilities:-
Look for patterns:
- URLs with sequential or guessable IDs
- API calls that include user_id, order_id, account_id
- Lack of 403 Forbidden when accessing other users' resources

Use a proxy (Burp Suite, mitmproxy) to modify requests and test object IDs.


#### ðŸŒ³ Tools and Automation for IDOR Testing
- Burp Repeater: Manually tamper with IDs
- Burp Intruder: Brute-force a range of object IDs
- Autorize: Detect broken access control by replaying requests with another session
- Access Control testing in Nuclei


#### ðŸŒ³ Bypassing Weak Authorization Checks
Common bypass techniques:
- Change numeric IDs (123 â†’ 122)
- Remove or change headers (X-User-ID, Authorization)
- Modify request methods (GET â†’ POST)
- Use another userâ€™s valid token with your request
- URL encoding (%2e, %2f, %00) to bypass filters


#### ðŸŒ³ Real-World Examples from Public Writeups
- Accessing another userâ€™s support ticket by changing the ID
- Downloading invoices of other users from predictable filenames
- Modifying another userâ€™s shipping address via API

These often lead to critical impact due to unauthorized access to sensitive data.


#### ðŸŒ³ Enhancing IDOR with Chaining Techniques
Combine IDOR with:
- Information Disclosure: Use IDOR to get email addresses or phone numbers
- Account Takeover: Access password reset tokens via IDOR
- SSRF or RCE: Control resources that trigger backend processing

Sometimes IDOR is just the door â€” the prize is behind it.


#### ðŸŒ³ Mitigations You Should Look For (and When They're Broken):- 
Developers often implement:
- Client-side checks only (easily bypassed)
- Hardcoded object limits
- Frontend role hiding (does not stop backend access)
- Incomplete access tokens

Good mitigations:
- Object ownership validation on the backend
- Role-based access enforcement
- UUIDs or opaque references (though not foolproof)


#### ðŸŒ³ Reporting IDOR Vulnerabilities Effectively
Your report should include:
- Step-by-step reproduction
- Proof of unauthorized access (screenshots, data dumps)
- Explanation of the impact (privacy violation, business logic flaw)
- Suggested remediation (e.g. server-side access validation)
