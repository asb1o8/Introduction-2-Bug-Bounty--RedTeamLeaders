## Open Redirect and URL Manipulation

   
#### ðŸŒ³ Open Redirect:-
-  Open Redirect: It happens when userâ€‘controlled input (like a URL parameter) is not validated, allowing attackers to
   redirect victims to malicious sites.
-  URL Manipulation: Involves changing query strings or path parameters in a URL to access unauthorized data or functions.

- ###### Both rely on unsanitized user input in URLs â†’ attackers tamper with parameters to achieve malicious outcomes.
- ###### This allows attackers to redirect users to malicious websites while making it appear as though the URL is trusted.

Example (vulnerable URL):

         https://example.com/login?next=https://malicious.com

If the application doesnâ€™t validate the next parameter, an attacker can abuse it in phishing campaigns or combine it with 
other exploits like token theft.


#### ðŸŒ³ Why It Matters:-
Open Redirects are considered low severity, but can become critical when:
- Used in phishing attacks (masking the malicious intent)
- Chained with OAuth token theft or SSO abuse
- Used for redirecting password reset links
- Abuse in email links to bypass security filters

They may not directly impact the applicationâ€™s data or state, but they degrade user trust and can become a critical 
vector when combined.


#### ðŸŒ³ Typical Usage Scenarios:-
Attackers use Open Redirects to:
- Redirect victims after phishing or social engineering
- Trick filters and security scanners that whitelist the domain
- Exfiltrate OAuth codes by redirecting users to malicious servers
- Abuse redirect parameters during login flows or multi-step actions


#### ðŸŒ³ Recognizing Open Redirect Parameters:-
Common names:
`next`, `redirect`, `url`, `return`, `callback`, `continue`, `dest`

These parameters are frequently found on login pages, logout endpoints, error handlers, or multi-step forms.


#### ðŸŒ³ Proof-of-Concept (PoC):-
Basic example:

      https://target.com/login?next=https://evil.com

If after login the browser redirects to evil.com, itâ€™s vulnerable.

An attacker can send:

      https://target.com/login?next=https://evil.com

In a phishing email, hiding the malicious intent behind a trusted domain `(target.com)`.


#### ðŸŒ³ Payloads for Testing:-
Payloads should be crafted to:
- Confirm redirection
- Bypass filters or allowlists

Examples:

         https://target.com/?redirect=https://evil.com
         https://target.com/?redirect=//evil.com
         https://target.com/?redirect=http:%5C%5Cevil.com
         https://target.com/?redirect=https://%65%76%69%6C.com

Other tricks:
- Use double encoding (%252f)
- Encode characters (%2e%2e)
- Use backslashes (\ instead of /)
- Use subdomains that appear internal (https://internal.evil.com)


#### ðŸŒ³ Relative vs Absolute Redirects:-
- Relative Redirects: Safer. Redirects only within the app (ex- /dashboard)
- Absolute Redirects: Dangerous if unchecked, as they can point to external domains

Some apps fail to enforce this distinction and allow attacker-supplied absolute URLs.


#### ðŸŒ³ Chaining with OAuth and SSO:-
Open Redirects are more dangerous when used in:
- OAuth redirect_uri flows
- SSO return URLs

Example:

         https://target.com/oauth?redirect_uri=https://evil.com

If accepted, it may allow attackers to:
- Steal access tokens
- Hijack accounts
- Manipulate authorization codes


#### ðŸŒ³ Prevention & Secure Implementation:- 
For developers:
- Validate and whitelist allowed redirect destinations
- Use relative paths instead of full URLs
- Reject URLs starting with http:// or https://
- Normalize and canonicalize inputs before comparing
- Consider storing state server-side instead of in query parameters


#### ðŸŒ³ Reporting and Bounty Impact:-
Some platforms consider Open Redirects low impact unless:
- It affects login or SSO flows
- It can be chained with OAuth misconfigurations
- It is used in phishing with real-world abuse potential

When reporting:
- Demonstrate the redirect
- Show impact (e.g., phishing, OAuth abuse)
- Include working PoC with screenshots or video if needed
- Be clear about the parameter and context

#### ðŸŒ³ Conclusion:-
Open Redirects are simple bugs that can become serious in the right context. A skilled hunter knows how to identify them, 
test for bypasses, and evaluate potential for abuse. Even if individually low-risk, chaining them with authentication 
flows or social engineering can yield high-value findings.
